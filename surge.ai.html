<!DOCTYPE html>
<html lang="ja">
<head>
<meta charset="UTF-8">
<title>SURGE AI Search</title>
<style>
  body { font-family: system-ui; background: #f7f7f7; margin: 0; padding: 20px; }
  .search-box { display: flex; gap: 8px; }
  input { flex: 1; padding: 10px; border: 1px solid #ccc; border-radius: 8px; }
  button { padding: 10px 16px; border: none; border-radius: 8px; background: #2d6cdf; color: #fff; cursor: pointer; }
  button:hover { background: #2458b8; }
  .results { margin-top: 20px; }
  .result { background: #fff; border-radius: 12px; padding: 14px; margin-bottom: 12px; box-shadow: 0 2px 6px rgba(0,0,0,0.08); }
  .result h3 { margin: 0 0 6px; font-size: 16px; }
  .result p { margin: 0; color: #555; font-size: 14px; }
</style>
</head>
<body>

<h1>SURGE AI 検索</h1>
<div class="search-box">
  <input id="query" placeholder="調べたいことを入力…" />
  <button onclick="doSearch()">検索</button>
</div>

<div class="results" id="results"></div>

<script>
async function doSearch() {
  const q = document.getElementById('query').value.trim();
  if (!q) return;

  const resultsEl = document.getElementById('results');
  resultsEl.innerHTML = "<p>検索中…</p>";

  try {
    // Workers経由でCopilotに検索リクエストを送る
    const res = await fetch("https://surgeai.proluce.workers.dev/", {
      method: "POST",
      headers: { "Content-Type": "application/json" },
      body: JSON.stringify({ inputs: `検索: ${q}` })
    });

    const data = await res.json();

    // Copilotが返す検索統合結果を表示
    resultsEl.innerHTML = "";
    if (Array.isArray(data)) {
      data.forEach(item => {
        const div = document.createElement("div");
        div.className = "result";
        div.innerHTML = `<h3>${item.title || "結果"}</h3><p>${item.text || item.generated_text || ""}</p>`;
        resultsEl.appendChild(div);
      });
    } else {
      const div = document.createElement("div");
      div.className = "result";
      div.innerHTML = `<h3>結果</h3><p>${data.generated_text || data.text || JSON.stringify(data)}</p>`;
      resultsEl.appendChild(div);
    }
  } catch (err) {
    resultsEl.innerHTML = `<p style="color:red">エラー: ${err.message}</p>`;
  }
}
</script>

</body>
</html>
