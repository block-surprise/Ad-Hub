<!DOCTYPE html>
<html lang="ja">
<head>
    <meta charset="UTF-8">
    <title>LOTTERY SYSTEM - PRO EDITION</title>
    <script src="https://cdn.jsdelivr.net/npm/canvas-confetti@1.5.1/dist/confetti.browser.min.js"></script>
    <style>
        :root {
            --main-color: #ffffff;
            --bg-color: #000000;
        }
        body {
            background-color: var(--bg-color);
            color: var(--main-color);
            font-family: 'Helvetica Neue', Arial, 'Hiragino Sans', sans-serif;
            margin: 0; overflow: hidden;
            display: flex; justify-content: center; align-items: center; height: 100vh;
        }

        /* 空間の奥行きを出す背景 */
        .stage {
            position: relative; width: 100%; text-align: center; z-index: 10;
        }

        /* 抽選中の文字。あえて少し小さめから、決定時に巨大化させる */
        #winner-name {
            font-size: 5vw; font-weight: 900; letter-spacing: 0.1em;
            transition: all 0.3s ease;
            text-transform: uppercase;
        }

        /* 決定時のスタイル */
        .announcing {
            font-size: 12vw !important;
            filter: drop-shadow(0 0 50px rgba(255,255,255,0.8));
            letter-spacing: 0.3em !important;
        }

        /* 下部の操作系は徹底的に隠す */
        .ui-layer {
            position: fixed; bottom: 40px; width: 100%;
            display: flex; justify-content: center; gap: 20px;
            opacity: 0; transition: opacity 0.5s;
        }
        body:hover .ui-layer { opacity: 1; } /* マウスを乗せた時だけ見える */

        button {
            background: none; border: 1px solid #444; color: #888;
            padding: 10px 30px; border-radius: 5px; cursor: pointer;
            font-size: 0.8rem; letter-spacing: 0.2em; transition: 0.3s;
        }
        button:hover { border-color: #fff; color: #fff; background: rgba(255,255,255,0.1); }

        /* 入力用パネル（左からスライド） */
        #input-panel {
            position: fixed; left: -400px; top: 0; width: 350px; height: 100%;
            background: #111; padding: 40px; transition: 0.6s cubic-bezier(0.16, 1, 0.3, 1);
            z-index: 100; border-right: 1px solid #333;
        }
        #input-panel.open { left: 0; }
        textarea {
            width: 100%; height: 70%; background: #000; color: #fff;
            border: 1px solid #333; padding: 15px; font-size: 1rem;
        }
    </style>
</head>
<body>

<div id="input-panel">
    <h2 style="font-size: 1rem; color: #666;">CANDIDATE LIST</h2>
    <textarea id="name-list" placeholder="名前を1行ずつ...">
GUEST 001
GUEST 002
GUEST 003
GUEST 004
GUEST 005</textarea>
    <button onclick="togglePanel()" style="margin-top: 20px; width: 100%;">CLOSE</button>
</div>

<div class="stage">
    <div id="winner-name">READY</div>
</div>

<div class="ui-layer">
    <button onclick="togglePanel()">EDIT LIST</button>
    <button id="start-btn" onclick="runLottery()">DRAW</button>
</div>

<script>
    function togglePanel() {
        document.getElementById('input-panel').classList.toggle('open');
    }

    function runLottery() {
        const list = document.getElementById('name-list').value.split('\n').filter(n => n.trim() !== "");
        if (list.length < 1) return;

        const display = document.getElementById('winner-name');
        const startBtn = document.getElementById('start-btn');
        
        startBtn.disabled = true;
        display.classList.remove('announcing');
        
        let duration = 5000; // 5秒かけてじっくり演出
        let start = Date.now();

        const roll = () => {
            const diff = Date.now() - start;
            const progress = diff / duration;
            
            // ランダムに名前を表示（徐々にスローダウン）
            display.innerText = list[Math.floor(Math.random() * list.length)];

            if (diff < duration) {
                // イージング：最後の方にいくほど極端に遅くする
                let delay = 30 + Math.pow(progress, 5) * 800;
                setTimeout(roll, delay);
            } else {
                // 決定！
                display.classList.add('announcing');
                confetti({
                    particleCount: 200, spread: 80, origin: { y: 0.6 },
                    colors: ['#ffffff', '#aaaaaa', '#444444']
                });
                startBtn.disabled = false;
                startBtn.innerText = "RE-DRAW";
            }
        };
        roll();
    }
</script>
</body>
</html>
