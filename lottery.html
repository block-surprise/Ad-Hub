<!DOCTYPE html>
<html lang="ja">
<head>
    <meta charset="UTF-8">
    <title>PREMIUM LOTTERY SHOW</title>
    <script src="https://cdn.jsdelivr.net/npm/canvas-confetti@1.5.1/dist/confetti.browser.min.js"></script>
    <style>
        :root {
            --gold: #d4af37;
            --panel-bg: #1a1a1a;
        }
        body {
            background-color: #000;
            color: white;
            font-family: 'Oswald', sans-serif; /* インパクトのあるフォント */
            margin: 0; overflow: hidden;
            display: flex; flex-direction: column; align-items: center; justify-content: center; height: 100vh;
        }

        /* 抽選リールの外枠 */
        .slot-machine {
            position: relative;
            width: 80%;
            height: 250px;
            border-top: 4px solid var(--gold);
            border-bottom: 4px solid var(--gold);
            background: linear-gradient(180deg, #000 0%, #222 50%, #000 100%);
            overflow: hidden;
            box-shadow: 0 0 50px rgba(212, 175, 55, 0.2);
        }

        /* 名前が並ぶコンテナ */
        #reel {
            position: absolute;
            width: 100%;
            top: 0;
            transition: transform 0s cubic-bezier(0.1, 0, 0, 1);
            will-change: transform;
        }

        .name-item {
            height: 250px;
            line-height: 250px;
            font-size: 8rem;
            font-weight: bold;
            text-align: center;
            text-transform: uppercase;
            letter-spacing: 5px;
            white-space: nowrap;
        }

        /* 中央のガイド線 */
        .pointer {
            position: absolute;
            top: 50%; width: 100%; height: 2px;
            background: rgba(212, 175, 55, 0.5);
            transform: translateY(-50%);
            z-index: 5;
        }

        /* 操作パネル */
        .ui { margin-top: 50px; z-index: 10; }
        #draw-btn {
            background: var(--gold); border: none; color: black;
            padding: 20px 60px; font-size: 1.5rem; font-weight: bold;
            cursor: pointer; border-radius: 5px; transition: 0.3s;
        }
        #draw-btn:hover { transform: scale(1.1); box-shadow: 0 0 30px var(--gold); }
        #draw-btn:disabled { background: #444; color: #888; cursor: not-allowed; }

        /* 設定エリア（左下に小さく） */
        .config { position: fixed; bottom: 10px; left: 10px; opacity: 0.2; }
        .config:hover { opacity: 1; }
        textarea { width: 200px; height: 100px; background: #222; color: #fff; border: 1px solid #444; }
    </style>
</head>
<body>

<div class="slot-machine">
    <div class="pointer"></div>
    <div id="reel">
        <div class="name-item">LOTTERY</div>
    </div>
</div>

<div class="ui">
    <button id="draw-btn" onclick="spin()">START SPIN</button>
</div>

<div class="config">
    <textarea id="names-list">
TAKAOKA
SATO
SUZUKI
ICHIKAWA
YAMAMOTO
NAKAMURA
KOBAYASHI
TAKAHASHI</textarea>
</div>

<script>
    const ITEM_HEIGHT = 250;

    function spin() {
        const btn = document.getElementById('draw-btn');
        const reel = document.getElementById('reel');
        const listText = document.getElementById('names-list').value.trim();
        let names = listText.split('\n').filter(n => n.trim() !== "");

        if (names.length < 1) return;
        
        btn.disabled = true;

        // リール用の配列を作成（ループして見えるように多めに配置）
        const displayNames = [...names];
        while (displayNames.length < 50) {
            displayNames.push(...names);
        }
        
        // 当選者を決める
        const winnerIndex = Math.floor(Math.random() * names.length);
        // 最終的な停止位置（下の方にある当選者の位置）を計算
        const stopIndex = displayNames.length - names.length + winnerIndex;
        
        // リールを初期化
        reel.innerHTML = '';
        displayNames.forEach(name => {
            const div = document.createElement('div');
            div.className = 'name-item';
            div.innerText = name;
            reel.appendChild(div);
        });

        // アニメーション設定
        reel.style.transition = 'none';
        reel.style.transform = 'translateY(0)';

        // わずかな遅延のあと回転開始
        setTimeout(() => {
            reel.style.transition = 'transform 6s cubic-bezier(0.15, 0, 0.05, 1)';
            const y = -(stopIndex * ITEM_HEIGHT);
            reel.style.transform = `translateY(${y}px)`;
        }, 50);

        // 終了時
        setTimeout(() => {
            confetti({
                particleCount: 250, spread: 100, origin: { y: 0.6 },
                colors: ['#d4af37', '#ffffff', '#aa8e2d']
            });
            btn.disabled = false;
            btn.innerText = "RE-SPIN";
        }, 6100);
    }
</script>
</body>
</html>
