<!DOCTYPE html>
<html lang="ja">
<head>
    <meta charset="UTF-8">
    <title>LOTTERY ENGINE v1.0</title>
    <script src="https://cdn.jsdelivr.net/npm/canvas-confetti@1.5.1/dist/confetti.browser.min.js"></script>
    <style>
        :root {
            --accent: #ffffff; /* ここを好きな色に変えるだけでオリジナリティが出ます */
            --bg: #050505;
        }
        body, html { margin: 0; padding: 0; height: 100%; background: var(--bg); color: white; font-family: "Inter", "Helvetica Neue", sans-serif; overflow: hidden; }
        
        /* メイン表示 */
        #canvas-wrapper {
            display: flex; flex-direction: column; justify-content: center; align-items: center; height: 100vh;
        }
        #name-display {
            font-size: clamp(3rem, 15vw, 10rem); font-weight: 800; letter-spacing: -0.02em;
            text-align: center; transition: 0.2s cubic-bezier(0.2, 0, 0, 1);
        }
        .blur { filter: blur(12px); opacity: 0.3; transform: scale(0.9); }

        /* 操作系 */
        .controls { position: fixed; bottom: 50px; width: 100%; text-align: center; }
        #action-btn {
            background: none; border: 1px solid rgba(255,255,255,0.3); color: white;
            padding: 12px 40px; border-radius: 100px; font-size: 0.9rem; cursor: pointer;
            backdrop-filter: blur(10px); transition: 0.3s;
        }
        #action-btn:hover { background: white; color: black; }

        /* 設定パネル（隠し要素） */
        #settings-panel {
            position: fixed; top: 0; right: -350px; width: 300px; height: 100%;
            background: rgba(20,20,20,0.9); backdrop-filter: blur(20px);
            padding: 30px; transition: 0.5s cubic-bezier(0.19, 1, 0.22, 1); z-index: 100;
        }
        #settings-panel.open { right: 0; }
        #config-trigger {
            position: fixed; top: 20px; right: 20px; cursor: pointer; opacity: 0.2; font-size: 1.5rem;
        }
        textarea {
            width: 100%; height: 70%; background: rgba(255,255,255,0.05); border: 1px solid #333;
            color: white; padding: 10px; border-radius: 8px; font-family: monospace;
        }
    </style>
</head>
<body>

<div id="config-trigger" onclick="toggleSettings()">⚙</div>

<div id="settings-panel">
    <h3>CANDIDATES</h3>
    <textarea id="names-input">
Member 01
Member 02
Member 03
Member 04
Member 05</textarea>
    <p style="font-size: 12px; color: #666;">1行に1人入力してください</p>
    <button onclick="toggleSettings()" style="width: 100%; padding: 10px;">CLOSE</button>
</div>

<div id="canvas-wrapper">
    <div id="name-display">READY</div>
    <div class="controls">
        <button id="action-btn" onclick="start()">RUN SYSTEM</button>
    </div>
</div>

<script>
    let isRunning = false;

    function toggleSettings() {
        document.getElementById('settings-panel').classList.toggle('open');
    }

    function start() {
        if (isRunning) return;
        
        const input = document.getElementById('names-input').value;
        const list = input.split('\n').filter(n => n.trim() !== "");
        if (list.length === 0) return;

        isRunning = true;
        const btn = document.getElementById('action-btn');
        const display = document.getElementById('name-display');
        
        btn.style.display = 'none';
        display.classList.add('blur');

        let count = 0;
        let speed = 50;
        const duration = 3500;
        const startTime = Date.now();

        const loop = () => {
            const now = Date.now();
            const elapsed = now - startTime;
            
            display.innerText = list[Math.floor(Math.random() * list.length)];

            if (elapsed < duration) {
                // 指数関数的に速度を落とす
                let progress = elapsed / duration;
                setTimeout(loop, speed + Math.pow(progress, 4) * 600);
            } else {
                finish(list);
            }
        };
        loop();
    }

    function finish(list) {
        const display = document.getElementById('name-display');
        const btn = document.getElementById('action-btn');
        
        display.innerText = list[Math.floor(Math.random() * list.length)];
        display.classList.remove('blur');
        
        // 洗練された紙吹雪演出
        confetti({
            particleCount: 100, spread: 70, origin: { y: 0.6 },
            colors: ['#ffffff', '#333333', '#666666']
        });

        setTimeout(() => {
            isRunning = false;
            btn.style.display = 'inline-block';
            btn.innerText = 'REBOOT';
        }, 1000);
    }
</script>
</body>
</html>
